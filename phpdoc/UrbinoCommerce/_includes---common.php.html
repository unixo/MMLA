<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs for page common.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="file-name"><img src="../media/images/Page_logo.png" alt="File" style="vertical-align: middle">/includes/common.php</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
									<a href="#sec-includes">Includes</a>
			|											<a href="#sec-functions">Functions</a>
			</div>
	<div class="info-box-body">	
		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Elenco funzioni comuni</p>
<p class="description"><p>Il file 'common.php' viene importato da tutte le pagine del sito, in modo  tale da ereditare tutte le variabili globali definite nel file 'config.php'  e le definizioni di classi e funzioni.</p><p>PHP Version 5</p></p>
	<ul class="tags">
				<li><span class="field">author:</span> Ferruccio Vitale &lt;<a href="mailto:unixo@devzero.it">unixo@devzero.it</a>&gt;</li>
				<li><span class="field">version:</span> SVN: $Id: common.php 32 2009-09-08 14:02:18Z unixo $</li>
				<li><span class="field">link:</span> <a href="http://commerce.devzero.it/">http://commerce.devzero.it/</a></li>
				<li><span class="field">license:</span> <a href="http://www.opensource.org/licenses/bsd-license.php">BSD License</a></li>
				<li><span class="field">filesource:</span> <a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html">Source Code for this file</a></li>
			</ul>
		
			</div>
</div>
		

	<a name="sec-includes"></a>	
	<div class="info-box">
		<div class="info-box-title">Includes</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
						<span class="disabled">Includes</span>
			|													<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<a name="_dirname(__FILE__)_/User_php"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">dirname(__FILE__).'/User.php'</span>)
			(line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a24">24</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_dirname(__FILE__)_/__/config_php"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">dirname(__FILE__).'/../config.php'</span>)
			(line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a26">26</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_MDB2_php"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">'MDB2.php'</span>)
			(line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a19">19</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_dirname(__FILE__)_/Basket_php"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">dirname(__FILE__).'/Basket.php'</span>)
			(line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a23">23</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_PEAR/Exception_php"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">'PEAR/Exception.php'</span>)
			(line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a22">22</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_Translation2_php"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">'Translation2.php'</span>)
			(line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a21">21</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_Log_php"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">'Log.php'</span>)
			(line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a20">20</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_dirname(__FILE__)_/Page_php"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">dirname(__FILE__).'/Page.php'</span>)
			(line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a25">25</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
		</div>
	</div>
	
	
	
	<a name="sec-functions"></a>	
	<div class="info-box">
		<div class="info-box-title">Functions</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
										<a href="#sec-includes">Includes</a>
				|												<span class="disabled">Functions</span>
		</div>
		<div class="info-box-body">	
			<a name="functioncheckSessionUser" id="functioncheckSessionUser"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">checkSessionUser</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a292">292</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Controllo esistenza istanza FV_User</p>
<p class="description"><p>Diverse pagine del sito necessitano di un'istanza della classe FV_User, sia  che si tratti di un utente regolarmente autenticato che di un visitatore  che sta visionando il catalogo e inserisce i prodotti nel carrello senza  essere ancora identificato/registrato.</p></p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			checkSessionUser
		</span>
				()
			</div>

		
	
</div>
<a name="functioncurrency" id="functioncurrency"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">currency</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a140">140</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Formattazione valuta</p>
<p class="description"><p>Formatta un numero usando la virgola come separatore decimale, il punto  come separatore delle migliaia e con due caratteri decimali.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> Numero formattato</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">integer</span>
		<span class="method-name">
			currency
		</span>
					(<span class="var-type">integer</span>&nbsp;<span class="var-name">$num</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">integer</span>
				<span class="var-name">$num</span><span class="var-description">: Numero da formattare</span>			</li>
				</ul>
		
	
</div>
<a name="functionerrorHandler" id="functionerrorHandler"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">errorHandler</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a49">49</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Handler eccezioni</p>
<p class="description"><p>La funzione viene richiamata qualora venga sollevata un'eccezione di tipo  PEAR_Exception o sue derivate: compito della funzione e' redirigere la  navigazione dell'utente verso la pagina d'errore contenente il messaggio  dell'eccezione.</p></p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			errorHandler
		</span>
					(<span class="var-type">PEAR_Exception</span>&nbsp;<span class="var-name">$pear_exception</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">PEAR_Exception</span>
				<span class="var-name">$pear_exception</span><span class="var-description">: Istanza dell'eccezione</span>			</li>
				</ul>
		
	
</div>
<a name="functionexecuteQuery" id="functionexecuteQuery"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">executeQuery</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a104">104</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Wrapper per interfacciarsi al database tramite istruzioni SQL</p>
<p class="description"><p>E' possibile effettuare una SELECT o una DML (UPDATE, INSERT). All'interno  della funzione viene fatto uso delle classi DB2 (PEAR) per creare lo  statement e, eventualmente, assegnare i valori alle rispettive  'bind variables'.  L'uso di questi accorgimenti previene possibili attacchi di tipo SQL  injection o XSS stored.</p><p>Esempio d'utilizzo:  <div class="src-code"><ol><li><div class="src-line">&nbsp;<span class="src-var">$results&nbsp;</span>=&nbsp;<a href="../UrbinoCommerce/_includes---common.php.html#functionexecuteQuery">executeQuery</a><span class="src-sym">(</span><span class="src-str">'SELECT&nbsp;*&nbsp;FROM&nbsp;tabella&nbsp;WHERE&nbsp;campo=?'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$valore</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&nbsp;echo&nbsp;<span class="src-str">'Numero&nbsp;di&nbsp;record&nbsp;trovati:&nbsp;'</span>.<a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$results</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
</ol></div></p></p>
	<ul class="tags">
				<li><span class="field">return:</span> Result set ottenuto dalla query (se fosse una SELECT)</li>
				<li><span class="field">usedby:</span> <a href="../UrbinoCommerce/FV_User.html">FV_User</a> - API per interfacciarsi con il database</li>
				<li><span class="field">usedby:</span> <a href="../UrbinoCommerce/FV_Page.html">FV_Page</a> - API per leggere le informazioni sui prodotti</li>
				<li><span class="field">usedby:</span> <a href="../UrbinoCommerce/FV_Basket.html">FV_Basket</a> - API per leggere le informazioni sui prodotti</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			executeQuery
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$sql</span>, [<span class="var-type">array</span>&nbsp;<span class="var-name">$values</span> = <span class="var-default">array()</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$sql</span><span class="var-description">: Comando SQL da eseguire</span>			</li>
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$values</span><span class="var-description">: Valore delle bind variables</span>			</li>
				</ul>
		
	
</div>
<a name="functiongeneratePassword" id="functiongeneratePassword"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">generatePassword</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a204">204</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Generazione password</p>
<p class="description"><p>Quando un'utente dimentica la propria password d'accesso, il sistema puo'  generare una nuova password che sia comunque conforme alle linee guida  del sito. La password verra' dunque inviata via mail all'utente.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> Password generata</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			generatePassword
		</span>
					([<span class="var-type">integer</span>&nbsp;<span class="var-name">$length</span> = <span class="var-default">8</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">integer</span>
				<span class="var-name">$length</span><span class="var-description">: Lunghezza della password da generare</span>			</li>
				</ul>
		
	
</div>
<a name="functiongenerateSecureCode" id="functiongenerateSecureCode"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">generateSecureCode</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a187">187</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Generazione ID univoco</p>
<p class="description"><p>Genera un identificativo univoco da associare all'utente che ha appena  terminato la procedura di registrazione: tale codice viene inviato via  mail all'indirizzo di posta specificato dall'utente, il quale, visitando il  link indicato, provvedera' ad attivare l'account.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> Codice univoco</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			generateSecureCode
		</span>
				()
			</div>

		
	
</div>
<a name="functiongetConfigValue" id="functiongetConfigValue"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">getConfigValue</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a247">247</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Lettura parametro di configurazione</p>
<p class="description"><p>Dato un parametro di configurazione salvato nella tabella 'config' della  base dati, la funzione ne restituisce il valore; se il parametro contiene  il carattere '%', la funzione restituisce un vettore di parametri che  corrispondono all'espressione regolare.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> Valore del parametro o vettore di valori</li>
				<li><span class="field">usedby:</span> <a href="../UrbinoCommerce/FV_Page.html">FV_Page</a> - API per leggere le impostazioni del sito</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">mixed</span>
		<span class="method-name">
			getConfigValue
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$attrib</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$attrib</span><span class="var-description">: Parametro da ricercare</span>			</li>
				</ul>
		
	
</div>
<a name="functiongetSMTPSettings" id="functiongetSMTPSettings"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">getSMTPSettings</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a310">310</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Impostazioni SMTP</p>
<p class="description"><p>Le classi o le pagine che necessitano di inviare una mail faranno uso di  questa funzione per ottenere le impostazioni del server SMTP.  Il vettore associativo restituito conterra' il nome del server, le  credenziali per l'smtp-auth e la stringa di HELO da inviare.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> Vettore associativo contenente i parametri del server SMTP</li>
				<li><span class="field">usedby:</span> <a href="../UrbinoCommerce/FV_User.html">FV_User</a> - Per ottenere le impostazione del server SMTP per
           inviare mail all'utente</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">mixed</span>
		<span class="method-name">
			getSMTPSettings
		</span>
				()
			</div>

		
	
</div>
<a name="functionneedAuthenticatedUser" id="functionneedAuthenticatedUser"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">needAuthenticatedUser</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a69">69</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Controllo autenticazione ed autorizzazione</p>
<p class="description"><p>La funzione verifica se l'utente che ha effettuato la richiesta risulta  essere autenticato e quindi autorizzato a vedere il contenuto della pagina.  Il parametro needAdmin eleva ulteriomente il livello di protezione: qualora  valga true, l'utente deve essere sia autenticato che amministratore.  Qualora non vengano soddisfatte le suddette condizioni, viene effettuata  una redirezione della navigazione verso la URL specificata.</p></p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			needAuthenticatedUser
		</span>
					([<span class="var-type">boolean</span>&nbsp;<span class="var-name">$needAdmin</span> = <span class="var-default">false</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$link</span> = <span class="var-default">&#039;index.php&#039;</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$needAdmin</span><span class="var-description">: Se vale true, l'utente deve essere un amministratore</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$link</span><span class="var-description">: Pagina verso la quale effettuare la redirezione</span>			</li>
				</ul>
		
	
</div>
<a name="functionprintRating" id="functionprintRating"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">printRating</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a159">159</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Valutazione del prodotto</p>
<p class="description"><p>Stampa la valutazione di un prodotto/recensione in una scala da 1 a 5: fa  uso di una particolare immagine a forma di 'stella', da ripetere fino a  rappresentare il valore di rating.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> Restituisce la stringa HTML del rating</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			printRating
		</span>
					(<span class="var-type">integer</span>&nbsp;<span class="var-name">$value</span>, [<span class="var-type">boolean</span>&nbsp;<span class="var-name">$print</span> = <span class="var-default">true</span>], [<span class="var-type">integer</span>&nbsp;<span class="var-name">$size</span> = <span class="var-default">19</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">integer</span>
				<span class="var-name">$value</span><span class="var-description">: Valore di rating</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$print</span><span class="var-description">: Se vale true, stampa il rating in output</span>			</li>
					<li>
				<span class="var-type">integer</span>
				<span class="var-name">$size</span><span class="var-description">: Dimensione dell'immagine (width)</span>			</li>
				</ul>
		
	
</div>
<a name="functionredirectToURL" id="functionredirectToURL"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">redirectToURL</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a228">228</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Funzione di redirezione</p>
<p class="description"><p>Funzione per redirigere la navigazione dell'utente alla pagina richiesta:  l'operazione viene effettuata inviando al browser l'header 'Location' e  terminando successivamente lo script con la funzione exit(), in modo tale  che non venga generato ulteriore output.</p></p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			redirectToURL
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$url</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$url</span><span class="var-description">: Pagina da visitare</span>			</li>
				</ul>
		
	
</div>
<a name="functionsetConfigValue" id="functionsetConfigValue"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../media/images/Function.png" />
		<span class="method-title">setConfigValue</span> (line <span class="line-number"><a href="../__filesource/fsource_UrbinoCommerce__includescommon.php.html#a275">275</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Impostazione parametro di configurazione</p>
<p class="description"><p>Dato un parametro di configurazione salvato nella tabella 'config' della  base dati, la funzione ne aggiorna il valore.</p></p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			setConfigValue
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$attrib</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$value</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$attrib</span><span class="var-description">: Parametro da modificare</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$value</span><span class="var-description">: Valore del parametro</span>			</li>
				</ul>
		
	
</div>
		</div>
	</div>
	
	<p class="notes" id="credit">
		Documentation generated on Wed, 09 Sep 2009 14:48:14 +0200 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</p>
	</div></body>
</html>